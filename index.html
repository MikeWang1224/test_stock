<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>æ¯æ—¥æ¨¡å‹åœ–è¡¨</title>

<style>
body {
  margin: 0;
  padding: 14px;
  background: #000;
  color: #fff;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto;
  line-height: 1.6;
}

h1 {
  font-size: 20px;
  margin-bottom: 6px;
  text-align: center;
}

.hint {
  text-align: center;
  font-size: 14px;
  color: #aaa;
  margin-bottom: 24px;
}

.stock-block {
  max-width: 900px;
  margin: 0 auto 44px auto;
  padding-left: 14px;
  border-left: 4px solid #444;
}

.stock-header {
  font-size: 20px;
  font-weight: 800;
  margin-bottom: 4px;
}

.stock-subhint {
  font-size: 13px;
  color: #aaa;
  margin-bottom: 8px;
}

/* ===== æ±ºç­–æ¢ ===== */
.decision-strip {
  font-size: 16px;
  font-weight: 800;
  padding: 10px 14px;
  margin: 10px 0 14px 0;
  border-radius: 6px;
  background: #111;
}

.decision-strip.up {
  border-left: 6px solid #4CAF50;
  color: #4CAF50;
}

.decision-strip.down {
  border-left: 6px solid #F44336;
  color: #F44336;
}

.decision-strip.neutral {
  border-left: 6px solid #FFC107;
  color: #FFC107;
}

.model-summary {
  font-size: 15px;
  font-weight: 700;
  margin-bottom: 10px;
}

.up { color: #4CAF50; }
.down { color: #F44336; }
.neutral { color: #FFC107; }

/* ===== ä¿¡å¿ƒæ¢ ===== */
.confidence-bar {
  height: 6px;
  background: #333;
  border-radius: 4px;
  overflow: hidden;
  margin-bottom: 18px;
}

.confidence-fill {
  height: 100%;
  background: linear-gradient(90deg, #FFC107, #4CAF50);
}

/* ===== åœ–å€ ===== */
.section {
  margin-bottom: 28px;
}

.section-title {
  font-size: 16px;
  font-weight: 700;
  margin-bottom: 10px;
}

.section-title.big {
  font-size: 18px;
}

img {
  width: 100%;
  border-radius: 6px;
  display: block;
  filter: contrast(1.05) saturate(1.05);
}

/* ===== æŠ˜ç–Š ===== */
.toggle-btn {
  cursor: pointer;
  color: #aaa;
}

.toggle-content {
  display: none;
  margin-top: 10px;
}

.toggle.open .toggle-content {
  display: block;
}

@media (min-width: 768px) {
  .stock-header { font-size: 26px; }
  .section-title { font-size: 22px; }
  .section-title.big { font-size: 26px; }
}
</style>
</head>

<body>

<h1>æ¯æ—¥æ¨¡å‹åœ–è¡¨</h1>
<div class="hint">çŸ­ç·šï¼æ˜æ—¥ï½œè¶¨å‹¢ï¼å¤šæ—¥çµæ§‹ï¼ˆé¡è‰²ä»¥çŸ­ç·šç‚ºæº–ï¼‰</div>

<div id="container"></div>

<script>
const IMG_FOLDER = "results";
const MAX_LOOKBACK_DAYS = 10;

/* mockï¼ˆä¹‹å¾Œå¯æ¥çœŸå¯¦æ¨¡å‹è¼¸å‡ºï¼‰ */
function mockModelOutput() {
  return {
    dir1: 0.45 + Math.random() * 0.3,
    dirN: 0.45 + Math.random() * 0.3
  };
}

const STOCKS = [
  { ticker: "2301.TW", name: "å…‰å¯¶ç§‘" },
  { ticker: "2408.TW", name: "å—äºç§‘" },
  { ticker: "8110.TW", name: "è¯æ±" }
];

function getTWDate(d = new Date()) {
  const tw = new Date(d.toLocaleString("en-US", { timeZone: "Asia/Taipei" }));
  return `${tw.getFullYear()}-${String(tw.getMonth()+1).padStart(2,"0")}-${String(tw.getDate()).padStart(2,"0")}`;
}

function loadImage(src) {
  return new Promise(res => {
    const img = new Image();
    img.onload = () => res(true);
    img.onerror = () => res(false);
    img.src = src + "?t=" + Date.now();
  });
}

async function findLatest(stock) {
  for (let i = 0; i <= MAX_LOOKBACK_DAYS; i++) {
    const d = new Date();
    d.setDate(d.getDate() - i);
    const ds = getTWDate(d);
    const pred = `${IMG_FOLDER}/${ds}_${stock.ticker}_pred.png`;
    const back = `${IMG_FOLDER}/${ds}_${stock.ticker}_backtest.png`;
    if (await loadImage(pred)) {
      return { date: ds, offset: i, pred, back, backOK: await loadImage(back) };
    }
  }
  return null;
}

function classify(p, mode) {
  if (p > 0.55) return ["up", mode==="short" ? "ğŸ“ˆ æ˜æ—¥åå¤š" : "ğŸ“ˆ è¶¨å‹¢åå¤š"];
  if (p < 0.45) return ["down", mode==="short" ? "ğŸ“‰ æ˜æ—¥åç©º" : "ğŸ“‰ è¶¨å‹¢åç©º"];
  return ["neutral", mode==="short" ? "âš ï¸ æ˜æ—¥éœ‡ç›ª" : "âš ï¸ è¶¨å‹¢ä¸­æ€§"];
}

async function main() {
  const c = document.getElementById("container");

  for (const s of STOCKS) {
    const found = await findLatest(s);
    if (!found) continue;

    const m = mockModelOutput();
    const [c1, t1] = classify(m.dir1, "short");
    const [, t2] = classify(m.dirN, "trend");
    const conf = Math.round(Math.max(m.dir1, m.dirN) * 100);

    const block = document.createElement("div");
    block.className = "stock-block";
    block.style.borderLeftColor =
      c1==="up" ? "#4CAF50" : c1==="down" ? "#F44336" : "#FFC107";

    block.innerHTML = `
      <div class="stock-header">${s.name}ï¼ˆ${s.ticker}ï¼‰ï½œ${found.date}</div>
      <div class="stock-subhint">${found.offset===0?"ï¼ˆä»Šæ—¥ï¼‰":`ï¼ˆå¾€å‰ ${found.offset} å¤©ï¼‰`}</div>

      <div class="decision-strip ${c1}">
        ğŸ‘‰ ${t1}ï½œ${t2}
      </div>

      <div class="model-summary ${c1}">
        æ˜æ—¥ ${(m.dir1*100).toFixed(0)}% ï½œ è¶¨å‹¢ ${(m.dirN*100).toFixed(0)}%
      </div>

      <div class="confidence-bar">
        <div class="confidence-fill" style="width:${conf}%"></div>
      </div>

      <div class="section">
        <div class="section-title">æ”¶ç›¤åƒ¹ï¼‹å‡ç·šï¼‹æ¨¡å‹é æ¸¬</div>
        <img src="${found.pred}">
      </div>

      ${found.backOK ? `
      <div class="section toggle">
        <div class="section-title big toggle-btn">æ˜¨æ—¥é æ¸¬ â†’ ä»Šæ—¥å¯¦éš›ï¼ˆé»æ“Šå±•é–‹ï¼‰</div>
        <div class="toggle-content">
          <img src="${found.back}">
        </div>
      </div>` : ""}
    `;

    c.appendChild(block);
  }
}

document.addEventListener("click", e => {
  if (e.target.classList.contains("toggle-btn")) {
    e.target.parentElement.classList.toggle("open");
  }
});

main();
</script>

</body>
</html>
<!-- BUILD_TIME Fri Dec 26 04:58:01 UTC 2025 -->
